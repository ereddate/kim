<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<style>
			.on{color:red;text-decoration:none;}
		</style>
	</head>
	<body>
		<div ng-app="test" ng-show="show" class="main">
			<div ng-page="home" ng-show="show">
				<div ng-view="headera">
					<div ng-control="nava"><a href="#" ng-item="gohomea" ng-click="gohome_click">home</a> <a href="#" ng-item="goproducta" ng-click="goproduct_click">product</a> <a href="#" ng-item="goservicea" ng-click="goservice_click">service</a></div>
				</div>
				<div ng-view="maina">
					<div ng-control="list" ng-list="getlist_post(list_callback)">
						<div ng-item="list_tmpl_{{id}}">
							<h1>{{title}}</h1>
							<p>{{decoration}}</p>
							<a href="#" ng-item="list_removeitem" ng-click="list_removeitem_click" data-id="{{id}}">删除</a> <a href="#" ng-item="list_upitem" ng-click="list_upitem_click" data-id="{{id}}">收起</a>
						</div>
					</div>
					<div ng-control="list_pagenum" ng-list="getnum_get"><a href="{{num}}" ng-item="pagenum_{{num}}" ng-click="pagenum_click">{{shownum}}</a></div>
					1
				</div>
				<div ng-view="footera">&copy;2015.</div>
			</div>
			<div ng-page="product" ng-show="hide">
				<div ng-view="headerb">
					<div ng-control="navb"><a href="#" ng-item="gohomeb" ng-click="gohome_click">home</a> <a href="#" ng-item="goproductb" ng-click="goproduct_click">product</a> <a href="#" ng-item="goserviceb" ng-click="goservice_click">service</a></div>
				</div>
				<div ng-view="mainb">
					<div ng-control="form" ng-tmpl="getform_get">
						<input type="text" value="{{test}}" name="test" ng-item="test_input" ng-keyup="test_keyup" />
						<p><span ng-item="test_result"></span></p>
					</div>
					2
				</div>
				<div ng-view="footerb">&copy;2015.</div>
			</div>
			<div ng-page="service" ng-show="hide">
				<div ng-view="headerc">
					<div ng-control="navc"><a href="#" ng-item="gohomec" ng-click="gohome_click">home</a> <a href="#" ng-item="goproductc" ng-click="goproduct_click">product</a> <a href="#" ng-item="goservicec" ng-click="goservice_click">service</a></div>
				</div>
				<div ng-view="mainc">
					<div ng-control="aaa">
						<select ng-item="select" name="select" ng-list="getselect_get" ng-change="select_change" ng-valid="required:不能为空:selecterror"><option value="{{value}}">{{title}}</option></select>
						<span ng-item="selectval"></span>
						<span ng-item="selecterror"></span>
						<input ng-item="inputvalid" name="inputvalid" ng-valid="required:不能为空:inputerror" value="" />
						<span ng-item="inputerror"></span>
						<input ng-item="inputvalid_a" name="inputvalid_a" ng-valid="required:不能为空:input_aerror" value="" />
						<span ng-item="input_aerror"></span>
						<div ng-item="modeltest" ng-test=""></div>
					</div>
					3
				</div>
				<div ng-view="footerc">&copy;2015.</div>
			</div>
		</div>

		<script src="jquery.js"></script>
		<script src="kim.js"></script>
		<script src="kim.valid.js"></script>
		<script src="kim.list.js"></script>
		<script src="kim.tmpl.js"></script>
		<script>
		;
		(function() {

			jQuery.kim.modelExtend({
				test: function(elem){
					var self = this;
					jQuery(elem).html("test");
					return this;
				}
			});

			jQuery.extend(jQuery.kim.fn, {
				toggle: function(app, type, val) {
					var self = this,
						elem;
					jQuery.each(self.app[app][type], function(name, obj) {
						if (name == val)(elem = obj, jQuery(obj).show().attr("ng-show", "show"));
						else jQuery(obj).hide().attr("ng-show", "hide");
					});
					self.get(elem);
					return this;
				},
				toggleClass: function(val, bool) {
					var self = this;
					self.get(typeof bool != "undefined" && jQuery(self).hasClass(val) == bool || jQuery(self).hasClass(val) ? jQuery(self).removeClass(val) : jQuery(self).addClass(val));
					return this;
				}
			});

			console.log(jQuery(".main").kim({
				initialization: function(){
					this.app["test"].item["gohomea"].click();
				},
				handle: {
					list_removeitem_click: function(e, target){
						e.preventDefault();
						jQuery(this).parents(".ng-item").hide();
					},
					list_upitem_click: function(e, target){
						e.preventDefault();
						var parent = target.app["test"].item["list_tmpl_"+jQuery(this).attr("data-id")];
						if (!jQuery(this).data("isshow")){
							var h = parent.height();
							jQuery(this).data("height", h).data("isshow", true);
							parent.animate({
								height: h/2
							}, "slow");
						}else{
							jQuery(this).data("isshow", false)
							parent.animate({
								height: jQuery(this).data("height", h)
							}, "slow");
						}
					},
					input_aerror: function(status, tip, target){
						jQuery(this).show().html(tip);
					},
					select_change:function(e, target){
						target.app["test"].item["selectval"].html(jQuery(this).val());
					},
					getselect_get: function(render, target){
						var data = [{
							value:"",
							title:"请选择..."
						},{
							value:1,
							title:"aaa"
						},{
							value:2,
							title:"bbb"
						},{
							value:3,
							title:"ccc"
						},{
							value:4,
							title:"ddd"
						}];
						render(data);
					},
					pagenum_click: function(e, target){
						e.preventDefault();
						alert(jQuery(this).attr("href"));
					},
					getform_get: function(render, target){
						var data = {
							test: "input data"
						};
						render(data);
					},
					test_keyup: function(e, target){
						target.app["test"].item["test_result"].html(jQuery(this).val());
					},
					getnum_get: function(render, target){
						render([{num:0, shownum:1},{num:1, shownum:2}]);
					},
					getlist_post: function(render, target){
							data = [
								{
									id:0,
									title:"adfasdfasdfas00",
									decoration:"adfasdfasdfasdfasdfasdfasd"
								},{
									id:1,
									title:"adfasdfasdfas11",
									decoration:"adfasdfasdfasdfasdfasdfasd"
								},{
									id:2,
									title:"adfasdfasdfas22",
									decoration:"adfasdfasdfasdfasdfasdfasd"
								},{
									id:3,
									title:"adfasdfasdfas33",
									decoration:"adfasdfasdfasdfasdfasdfasd"
								}
							];
							render(data);
					},
					list_callback: function(elem, target){
						console.log(elem)
					},
					gohome_click: function(e, target){
						e.preventDefault();
						target.toggle("test", "page", "home").find("ng-item").toggleClass('on', false).eq("ng-item-gohomea").toggleClass('on');
					},
					goproduct_click: function(e, target){
						e.preventDefault();
						target.toggle("test", "page", "product").find("ng-item").toggleClass('on', false).eq("ng-item-goproductb").toggleClass('on');
					},
					goservice_click: function(e, target){
						e.preventDefault();
						target.toggle("test", "page", "service").find("ng-item").toggleClass('on', false).eq("ng-item-goservicec").toggleClass('on');
					}
				}
			}));

		})()
		</script>
	</body>
</html>